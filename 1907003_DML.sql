---insert into customer_details

insert into customer_details values(101136285,'Karim Hasan',01711098735,'karim@gmail.com','121,1/2 Paikgacha Road, Khulna-9203');

insert into customer_details values(101136851,'Rahim Hossain',01711098736,'rahimhossain@gmail.com','89 Boro Bazar, Tongi, Gazipur-9204');

insert into customer_details values(101136852,'Mahim Hossain',01711098737,'mahimhossain@gmail.com','100 Choto Bazar, Tongi, Gazipur-9204');

insert into customer_details values(101136853,'Mahim Hossain',01711098738,'mahimhossain@gmail.com','70 Gollamari Main, Khulna-9203');


insert into customer_details values(101136854,'Abdullah Khan',01711098739,'akhan@gmail.com','70, Gollamari Main Khulna-9203');

insert into customer_details values(101136855,'Abdulla Rahman',01711098740,'abrahman@gmail.com','5, Sonadanga Main, Khulna-9203');

insert into customer_details values(101136856,'Sadi Haque',01711098741,'shaque@gmail.com','6 Sonadanga Main Khulna-9203');

insert into customer_details values(101136857,'Dipto Saha',01711098742,'dsaha@gmail.com','80 Nirala Main, Khulna-9206');

insert into customer_details values(101136858,'Dipti Begum',01711098743,'dbegum@gmail.com','49,Nirala Main, Khulna-9206');


insert into customer_details values(101136859,'Prapty Roy',01711098744,'royprapty@gmail.com','10, Kuet Main, Khulna-9203');

insert into customer_details values(101136860,'Monika Modak',01711098745,'monika5@gmail.com','10, Pabla Main, Daulatpur, Khulna-9208');


----insert into car_details




insert into car_details values('DHAKA-DHA-11-9999','JAPS1X','TOYOTA SUPRA',2004,10000,'GOOD');

insert into car_details values('DHAKA-KA-15-998','JAPS2X','TATA INDIGO',2014,15000,'GOOD');


insert into car_details values('KHULNA-KA-16-9908','JAPS3X','SUZUKI DZIRE',2010,20000,'WORKING');


insert into car_details values('CHITTAGONG-KA-16-9908','KAPS3X','FORD MUSTANG',2015,5000,'BEST');


insert into car_details values('BARISHAL-KHA-20-9995','KAPS45X','TOYOTA ALLION',2013,25000,'GOOD');


insert into car_details values('DHAKA-KA-12-7777','RAPS995X','TOYOTA COROLLA',2003,35000,'WORKING');


insert into car_details values('KHULNA-KA-17-7787','KAPS795X','SUZUKI ALTO800',2001,45000,'WORKING');


insert into car_details values('KHULNA-KHA-17-7087','BAPS7X','HYUNDAI EAGLE',2018,15000,'BEST');


insert into car_details values('DHAKA-DA-17-3741','DAPS90X','MAHINDRA HICE',2017,25000,'BEST');


insert into car_details values('RANGPUR-DA-14-1254','RAPS77X','TOYOTA AXIO',2007,45000,'WORKING');

insert into car_details values('RANGPUR-TA-24-1234','BAPS79X','TOYOTA AXIO',2007,15000,'GOOD');




----insert into dest_details entry




insert into dest_details values(1001,'Sotobari','Paikgacha Main,Khulna-9803');

insert into dest_details values(1002,'Dhanmondi','Dhanmondi 32,Dhaka-1237');


insert into dest_details values(1003,'Mongla','Port Main,Bagerhat-5874');


insert into dest_details values(1004,'CUET','Pahartali Road,Chittagong-1244');


insert into dest_details values(1005,'Circuit House','Main Bazar Road,Satkhira-6784');


insert into dest_details values(1006,'Lalon Bridge','Rooppur,Pabna-8756');


insert into dest_details values(1007,'Silaidaha','Kuthi Road,Khustia-7790');

insert into dest_details values(1008,'Agargaon','Bijoy Sarani,Dhaka-1289');


insert into dest_details values(1009,'Padma Bridge','Bridge Road Gopalganj-3489');


insert into dest_details values(1010,'Kuakata','Beach Road,Patuakhali-4022');





----insert into ins_details





insert into ins_details values(4001,'COLLISION CONTROL','covers theft and collision waiver',100);

insert into ins_details values(4002,'COLLISION CONTROL ONLY','covers collision waiver',90);

insert into ins_details values(4003,'THEFT CONTROL ONLY','covers theft waiver',80);

insert into ins_details values(4004,'LIABILITY CONTROL ONLY','covers damage done to others waiver',500);

insert into ins_details values(4005,'LIABILITY CONTROL AND THEFT','covers damage done to others and theft waiver',600);


insert into ins_details values(4006,'MEDICAL ASSISTANCE','covers medical cost waiver',1000);

insert into ins_details values(4007,'MEDICAL ASSISTANCE AND LIABILITY','covers medical cost and damage done waiver',1000);

insert into ins_details values(4008,'MEDICAL ASSISTANCE AND COLLISION','covers medical cost and collision waiver',1500);


insert into ins_details values(4009,'ALL IN ONE','covers everything under 1 pack',3500);


insert into ins_details values(4010,'LIFE INSURANCE','covers life insurance',2500);




----insert into booking_details entry


insert into booking_details values(5001,date '2023-01-17',date '2023-01-20',1001,'DHAKA-DHA-11-9999',4001,5000,2000,500,101136285);

insert into booking_details values(5002,date '2023-02-23',date '2023-02-28',1002,'DHAKA-KA-15-998',4002,7000,1000,500,101136851);

insert into booking_details values(5003,date '2023-03-03',date '2023-03-07',1003,'DHAKA-KA-15-998',4002,9000,3000,700,101136852);


insert into booking_details values(5004,date '2023-04-13',date '2023-04-16',1004,'KHULNA-KA-16-9908',4003,4000,3000,700,101136853);


insert into booking_details values(5005,date '2023-02-10',date '2023-02-15',1005,'CHITTAGONG-KA-16-9908',4004,6000,3000,500,101136854);

insert into booking_details values(5006,date '2023-03-10',date '2023-03-13',1006,'BARISHAL-KHA-20-9995',4004,4000,2000,500,101136855);

insert into booking_details values(5007,date '2023-05-11',date '2023-05-14',1006,'BARISHAL-KHA-20-9995',4005,5000,1000,500,101136856);


insert into booking_details values(5008,date '2023-05-12',date '2023-05-15',1007,'KHULNA-KA-17-7787',4006,5000,0,600,101136857);

insert into booking_details values(5009,date '2023-01-12',date '2023-01-15',1008,'KHULNA-KA-17-7787',4006,4000,500,600,101136858);


insert into booking_details values(5010,date '2023-04-22',date '2023-04-25',1009,'RANGPUR-DA-14-1254',4007,7000,1500,700,101136859);





----integrity constant check

insert into booking_details values(5011,date '2023-04-22',date '2023-04-25',1009,'RANGPUR-DA-14-1254',4007,7000,1500,700,101136809);


--displaying table data using select command

select * from car_details where mileage<20000;

select * from dest_details where dest_id=(select dest_id from booking_details where due_amount=1500);

select * from dest_details where dest_id=(select dest_id from booking_details where ins_code=(select ins_code from ins_details where cost_per_day=80));


----updating the data in the table

update booking_details set ins_code=4008 where booking_id=5009;


---deleting row from database


insert into ins_details values(4012,'CASE CONTROL','covers lawsuit waiver',5000);

delete from ins_details where ins_code=4012;

select * from ins_details;



---union query

select dest_name from dest_details where dest_name like '%E%' union select dest_name from dest_details where dest_name like 'A%';

--intersect query

select dest_name from dest_details where dest_name like '%o%' intersect select dest_name from dest_details where dest_name like '%i%';

--except query

 select dest_name from dest_details where dest_name like '%o%' except select dest_name from dest_details where dest_name like '%i%';



--Aggregate Function


--count
select count(*) from customer_details;

select count(distinct name) as distinct_name from customer_details;

--avg 


select avg(cost_per_day) as avg_cost from ins_details;

--sum

select sum(due_amount) as total_due from booking_details;

--MAX

select max(paid_amount) as max_paid from booking_details;

--MIN

select min(model_year) as oldest from car_details;


--group by

select model_year, avg(mileage) from car_details group by model_year;


--group by with having

select model_year, avg(mileage) from car_details group by model_year having model_year>2004;

--with clause

with best_mileage(val) as (select min(mileage) from car_details)
select * from best_mileage,car_details where car_details.mileage=best_mileage.val;


--nested subquery

select nid,name from customer_details where nid=(select nid from booking_details where ins_code=(select ins_code from ins_details where ins_code=4001));


--String Operations

select * from customer_details where name like 'D%';


select * from customer_details where name like '%n';

select * from customer_details where name like '%M%M%';

select * from customer_details where name like '__________';


select * from customer_details where name like '__________' or name like '___________' or name like '____________';



--Join Operations


--Natural Join and join

select * from customer_details join booking_details using(nid);

select * from car_details natural join booking_details;


--Left Outer Join

select * from car_details left outer join booking_details using(reg_no);

--Right Outer Join

select * from booking_details right outer join dest_details using (dest_id);


--Full Outer Join

select * from car_details full outer join booking_details using(reg_no);





--set membership 

select * from customer_details where name like 'Mahim%' and nid in(select nid from booking_details where reg_no like 'DHAKA%');

select * from customer_details where name like 'Mahim%' and nid not in(select nid from booking_details where reg_no like 'KHULNA%');

select * from customer_details where name like 'Mahim%' and nid not in(select nid from booking_details where reg_no like 'DHAKA%');


select * from customer_details where name like 'Mahim%' or nid in(select nid from booking_details where reg_no like 'DHAKA%');


--Some/all/exists


select * from booking_details where due_amount< some(select avg(due_amount) from booking_details);

select * from booking_details where paid_amount> all(select avg(paid_amount) from booking_details);

select * from customer_details where name like 'D%' and exists (select model_year from car_details where model_year<2010);


--View

create view details  as select ins_name,coverage_type from ins_details;

select * from details;


create view extra_insight1 as select dest_address from dest_details where dest_id=(select dest_id from booking_details where reg_no like 'C%');

select * from extra_insight1;


create view more_details1 as select start_time, email_id from customer_details join booking_details using(nid);
select * from more_details1;

select * from more_details1;


--check constraint check

insert into booking_details values(5009,date '2023-01-12',date '2023-01-10',1008,'KHULNA-KA-17-7787',4006,4000,500,600,101136858);

insert into car_details values('RANGPUR-TA-24-1234','BAPS79X','TOYOTA AXIO',2007,15000,'GOOD1');

